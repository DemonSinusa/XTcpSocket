# XTcpSocket
Библиотека синхронных не блокирующих кроcсплатформеных socket-ов
Краткое описание:
### ** "TCPClient.h"**



    SCT *InitClient(int domain, int type, int flags, int protocol, int rbuflen);
Инициализация сесии все параметры дублируют системные параметры за исключением размера буфера rbuflen.
Это размер буфера приема-передачи (размер окна) для медленных соединений меньший буфер.
Ничего лишнего придумывать не надо.



    int SetCallBacksC(SCT *cl,
    	    int (*OnRead)(SCT *cl, char *buf, int len),
    	    int (*OnWrite)(SCT *cl, int len),
    	    void (*OnDisconnected)(SCT *cl),
    	    void (*OnErr)(SCT *cl, int err));
Всевозможные событийные функции, вызываются когда наступает определенное событие или не вызываются если не назначены.
*Возвращает количество назначеных событий.*
**!Не/назначаются единовременно!**
1.  int (*OnRead)(SCT *cl, char *buf, int len)- Вызывается когда есть входящий поток buf размером len. (return!=0)Disconect();
2.  int (*OnWrite)(SCT *cl, int len)- Вызывается после отправки буфера длиной len.(return!=0)Disconect();
3.  void (*OnDisconnected)(SCT *cl)- Вызывается после закрытия соединения
4.  void (*OnErr)(SCT *cl, int err))- Вызывается при различных ошибках возвращает код ошибки.
Рекомендую определить int OnRead(SCT *cl, char *buf, int len) без нее не получится прочитать входной поток, он будет игнорироваться.



    int Connect(SCT *cl, char *host, char *port);
Попытка соединиться host может быть доменным именем и port можно текстом
возвращает 	0 при успехе.
- 			-1 при ошибке преобразования адреса.
- 			-2 при ошибке получения информации о хосте.


    int Send(SCT *cl, char *buf, int len);
Отправка buf размером len. Возвращает количество переданных байт. 



    void FinitClient(SCT *cl);
Завершение сесии и чистка структуры.

### "TCPServer.h"



    SST *InitServer(int domain, int type, int flags, int protocol, int rbuflen);
нициализация сесии все параметры дублируют системные параметры за исключением размера буфера rbuflen.
Это размер буфера приема-передачи (размер окна) для медленных соединений меньший буфер.
Ничего лишнего придумывать не надо.



    int SetCallBacksS(SST *serv,
    	    void (*OnConnected)(SST *serv, LCL *cl),
    	    int (*OnRead)(SST *serv, LCL *cl, char *buf, int len),
    	    int (*OnWrite)(SST *serv, LCL *cl, int len),
    	    void (*OnDisconnected)(SST *serv, LCL *cl),
    	    void (*OnErr)(SST *serv, int err));
Всевозможные событийные функции, вызываются когда наступает определенное событие или не вызываются если не назначены.  
*Возвращает количество назначеных событий.*
**!Не/назначаются единовременно!**
1.	void (*OnConnected)(SST *serv, LCL *cl)-Вызывается в момент связывания с новым клиентом (*cl).
2. 	int (*OnRead)(SST *serv, LCL *cl, char *buf, int len)-Вызывается для каждого отдельного клиента (*.cl) с массивом buf размером len
3. 	int (*OnWrite)(SST *serv, LCL *cl, int len)-Вызывается после отправки клиенту (*.cl) буфера длиной len 
4.  void (*OnDisconnected)(SST *serv, LCL *cl)-Вызывается после отключения клиента (*.cl) 
5.  void (*OnErr)(SST *serv, int err))-Вызывается при различных ошибках.



    int Listen(SST *, char *host, char *port);
Попытка поставить на прослушку host может быть доменным именем и port можно текстом
возвращает 	0 при успехе.
- 			-1 при ошибке преобразования адреса.
- 			-2 при ошибке получения информации о хосте.
- 			-3 при ошибке установки на прослушку.
- 			-4 при ошибке создания потока.


    int SendToClient(LCL *cl, char *buf, int len);
Отправка подключенному клиенту cl данных buf размером len. Возвращает количество переданных байт.



    void FinitServer(SST *);
Завершение сесии и чистка структуры.


Коды ошибок:
		-10:Ошибка преобразования имени
		-20:Ошибка получения адресов и информации о них
		-30:Ошибка установки свойств сокета
		-40:Ошибка установки на прослушку
		-50:Ошибка установки свойств потока
		-60:Ошибка запуска потока
		-100:Ошибка передачи данных.
